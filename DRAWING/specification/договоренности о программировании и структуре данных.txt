1 - читать структура спецификации.txt


используемфые параметры
xls-head
(lst>excell '(("func" "KKS" "meas_name" "рег" "Diam_tr" "sign_type" "прототип" "min_val" "nom_val" "max_val" "units" "T" "P" "F" "scale" "sampling_device" "комплект" "remarks" "place_sensor" "place_cpu" "special")))
список из string содержащих названия столбцов из excel
xls-data - таблица данных по заголовку xls-head
(setq db:data (append '("table") xls-data))

xlsline - 1 строка из xls-data формата xls-head
xlslines - несколько строк xlsline

grafaname - (("" "" ... )("" "название точек измерения" "" ... )("" "" "" "" "" ""))
список строк данных для заполнения спц.

gen-paragraf - формирует список который нельзя разделять на листы



add-grapha - добавляет 1 линию данных спецификации
принимает	pt - точку вставки (верхнюю левую точку - левую точку верхней линии row спецификации, того row в которую можно вставлять)
			list9strings - спиок строк-данных
вычисляет наибольшую высоту вставленных текстовых объектов
и возвращает следующую точку вставки в которую можно вставлять новую графу
без пропуска row

add-paragraph - добаволяет несколько строк спецификации
принимает	pt - точку вставки (верхнюю левую точку - левую точку верхней линии row спецификации, того row в которую можно вставлять)
			




КОРОЧЕ все зависит от количества уровней объединения данных xls-data, например

давление    - 2(два) уровня - по названию точек измерения, потом по типу датчика (xls-data -> datazipped -> datazipped2)

исходя из осмысленных на этот момент факторов буду делать РОС

1 формируем список данных, объединенных по типу прибора xls-data -> datazipped
отдельная запись заказа в специф. будет состоять из 3х граф:
1 названия точек измерения
2 строчки заказа прибора
3 перечня соответственных мест установки приборов, (хм... или одного общего если совпадает)

gen-zakaz-ROS - принимает несколько строчек - xlslines (только для того чтобы сформировать перечень позиций, относящихся к данному заказу)

в процессе осознал рациональность создания еще одной функции
формирования string, содержащей через запятую перечень соответственных параметров из xlslines
genstringfromxlsline - spc|gsfxl





TT температура
POINT 
1(один) уровень объединения - по типам датчиков (xls-data -> datazipped)





====================================================================================
=================    название функций, переменных и констант    ====================
====================================================================================
apc: - префикс переменной
#apc: - префикс константы (вне пределов файла)
$apc: - константы в пределай файла - из главной вызывающей функции, константа, используемая в подчиненных функциях

apc| - префикс функции относящийся к конкретному типу приборов - тут - апплисенс - APC-2000

#apc:catranges - константа - список диапазонов измерения приборов APC

*get* - вычислятор какого -нибудь определяющего параметра выбора
*gen* - формировщик окончиательной таблицы (списка 2 порядка) для вывода - либо графы либо параграфа, в общем списка списков '((1 2 ... 9)(1 2 ... 9)...)

#spclist9stringsparamlist - таблица параметров вывода 1-ной строки таблицы спецификации
(setq #spclist9stringsparamlist '((("object" "MTEXT")("dpt" '( 0.8 -3 0))("attch" 1)("width" 18.4)) (("object" "MTEXT")("dpt" '( 22 -3 0))("attch" 1)("width" 126))(("object" "MTEXT")("dpt" '( 152 -3 0))("attch" 1)("width" 56))(("object" "TEXT")("dpt" '( 227.5 -4 0)))(("object" "MTEXT")("dpt" '( 247 -3 0))("attch" 2)("width" 41))(("object" "TEXT")("dpt" '( 300 -4 0)))(("object" "TEXT")("dpt" '( 320 -4 0)))(("object" "TEXT")("dpt" '( 342.5 -4 0)))(("object" "MTEXT")("dpt" '( 357 -3 0))("attch" 1)("width" 36))))

spcadd| - функции добавления графики в модель




















